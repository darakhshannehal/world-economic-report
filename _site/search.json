[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "World Economic Report",
    "section": "",
    "text": "# import libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(RColorBrewer)\nlibrary(viridis)\nlibrary(patchwork)\nlibrary(skimr)\n\n\nData Preparation and QA\n\n# Load world bank data\nworld_bank = read_xlsx(path = \"WorldBank.xlsx\")\nhead(world_bank)\n\n# A tibble: 6 × 15\n  `Country Name` `Country Code` Region  IncomeGroup  Year Birth rate, crude (p…¹\n  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;                  &lt;dbl&gt;\n1 Afghanistan    AFG            South … Low income   2018                   NA  \n2 Afghanistan    AFG            South … Low income   2017                   33.2\n3 Afghanistan    AFG            South … Low income   2016                   34.0\n4 Afghanistan    AFG            South … Low income   2015                   34.8\n5 Afghanistan    AFG            South … Low income   2014                   35.7\n6 Afghanistan    AFG            South … Low income   2013                   36.7\n# ℹ abbreviated name: ¹​`Birth rate, crude (per 1,000 people)`\n# ℹ 9 more variables: `Death rate, crude (per 1,000 people)` &lt;dbl&gt;,\n#   `Electric power consumption (kWh per capita)` &lt;dbl&gt;, `GDP (USD)` &lt;dbl&gt;,\n#   `GDP per capita (USD)` &lt;dbl&gt;,\n#   `Individuals using the Internet (% of population)` &lt;dbl&gt;,\n#   `Infant mortality rate (per 1,000 live births)` &lt;dbl&gt;,\n#   `Life expectancy at birth (years)` &lt;dbl&gt;, …\n\n# Check data types\nglimpse(world_bank)\n\nRows: 12,449\nColumns: 15\n$ `Country Name`                                                 &lt;chr&gt; \"Afghan…\n$ `Country Code`                                                 &lt;chr&gt; \"AFG\", …\n$ Region                                                         &lt;chr&gt; \"South …\n$ IncomeGroup                                                    &lt;chr&gt; \"Low in…\n$ Year                                                           &lt;dbl&gt; 2018, 2…\n$ `Birth rate, crude (per 1,000 people)`                         &lt;dbl&gt; NA, 33.…\n$ `Death rate, crude (per 1,000 people)`                         &lt;dbl&gt; NA, 6.5…\n$ `Electric power consumption (kWh per capita)`                  &lt;dbl&gt; NA, NA,…\n$ `GDP (USD)`                                                    &lt;dbl&gt; 1936300…\n$ `GDP per capita (USD)`                                         &lt;dbl&gt; 520.897…\n$ `Individuals using the Internet (% of population)`             &lt;dbl&gt; NA, 13.…\n$ `Infant mortality rate (per 1,000 live births)`                &lt;dbl&gt; 47.9, 4…\n$ `Life expectancy at birth (years)`                             &lt;dbl&gt; NA, 64.…\n$ `Population density (people per sq. km of land area)`          &lt;dbl&gt; 56.9378…\n$ `Unemployment (% of total labor force) (modeled ILO estimate)` &lt;dbl&gt; 1.542, …\n\n\n\n# Calculate population \nworld_bank &lt;- world_bank %&gt;% \nmutate(`Population (M)` = (`GDP (USD)` / `GDP per capita (USD)`) / 1e6)\nhead(world_bank)\n\n# A tibble: 6 × 16\n  `Country Name` `Country Code` Region  IncomeGroup  Year Birth rate, crude (p…¹\n  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;                  &lt;dbl&gt;\n1 Afghanistan    AFG            South … Low income   2018                   NA  \n2 Afghanistan    AFG            South … Low income   2017                   33.2\n3 Afghanistan    AFG            South … Low income   2016                   34.0\n4 Afghanistan    AFG            South … Low income   2015                   34.8\n5 Afghanistan    AFG            South … Low income   2014                   35.7\n6 Afghanistan    AFG            South … Low income   2013                   36.7\n# ℹ abbreviated name: ¹​`Birth rate, crude (per 1,000 people)`\n# ℹ 10 more variables: `Death rate, crude (per 1,000 people)` &lt;dbl&gt;,\n#   `Electric power consumption (kWh per capita)` &lt;dbl&gt;, `GDP (USD)` &lt;dbl&gt;,\n#   `GDP per capita (USD)` &lt;dbl&gt;,\n#   `Individuals using the Internet (% of population)` &lt;dbl&gt;,\n#   `Infant mortality rate (per 1,000 live births)` &lt;dbl&gt;,\n#   `Life expectancy at birth (years)` &lt;dbl&gt;, …\n\n# Review missing values as % of total DataFrame\ncolSums(is.na(world_bank)) / nrow(world_bank) *100\n\n                                                Country Name \n                                                    0.000000 \n                                                Country Code \n                                                    0.000000 \n                                                      Region \n                                                    0.000000 \n                                                 IncomeGroup \n                                                    0.000000 \n                                                        Year \n                                                    0.000000 \n                        Birth rate, crude (per 1,000 people) \n                                                    8.105069 \n                        Death rate, crude (per 1,000 people) \n                                                    8.297855 \n                 Electric power consumption (kWh per capita) \n                                                   53.024339 \n                                                   GDP (USD) \n                                                   23.062093 \n                                        GDP per capita (USD) \n                                                   23.086192 \n            Individuals using the Internet (% of population) \n                                                   59.322034 \n               Infant mortality rate (per 1,000 live births) \n                                                   19.800787 \n                            Life expectancy at birth (years) \n                                                   10.225721 \n         Population density (people per sq. km of land area) \n                                                    4.851795 \nUnemployment (% of total labor force) (modeled ILO estimate) \n                                                   58.165314 \n                                              Population (M) \n                                                   23.086192 \n\n# Summary of the Dataset\nskim(world_bank) \n\n\nData summary\n\n\nName\nworld_bank\n\n\nNumber of rows\n12449\n\n\nNumber of columns\n16\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n4\n\n\nnumeric\n12\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nCountry Name\n0\n1\n4\n30\n0\n211\n0\n\n\nCountry Code\n0\n1\n3\n3\n0\n211\n0\n\n\nRegion\n0\n1\n10\n26\n0\n7\n0\n\n\nIncomeGroup\n0\n1\n10\n20\n0\n5\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nYear\n0\n1.00\n1.98900e+03\n1.703000e+01\n1960.00\n1.97400e+03\n1.989000e+03\n2.004000e+03\n2.01800e+03\n▇▇▇▇▇\n\n\nBirth rate, crude (per 1,000 people)\n1009\n0.92\n2.86400e+01\n1.313000e+01\n6.90\n1.66000e+01\n2.755000e+01\n4.088000e+01\n5.82300e+01\n▇▇▆▇▂\n\n\nDeath rate, crude (per 1,000 people)\n1033\n0.92\n1.05900e+01\n5.490000e+00\n1.13\n6.86000e+00\n9.200000e+00\n1.269000e+01\n5.44400e+01\n▇▃▁▁▁\n\n\nElectric power consumption (kWh per capita)\n6601\n0.47\n3.17529e+03\n4.467140e+03\n0.00\n3.90390e+02\n1.541890e+03\n4.313770e+03\n5.47992e+04\n▇▁▁▁▁\n\n\nGDP (USD)\n2871\n0.77\n1.70074e+11\n8.979866e+11\n8824450.00\n1.39301e+09\n7.275305e+09\n4.857783e+10\n2.05000e+13\n▇▁▁▁▁\n\n\nGDP per capita (USD)\n2874\n0.77\n8.23181e+03\n1.617354e+04\n34.79\n5.13150e+02\n1.852810e+03\n7.774570e+03\n1.89171e+05\n▇▁▁▁▁\n\n\nIndividuals using the Internet (% of population)\n7385\n0.41\n2.33300e+01\n2.832000e+01\n0.00\n5.90000e-01\n8.410000e+00\n4.130000e+01\n1.00000e+02\n▇▂▁▁▁\n\n\nInfant mortality rate (per 1,000 live births)\n2465\n0.80\n5.17000e+01\n4.613000e+01\n1.40\n1.44700e+01\n3.700000e+01\n7.820000e+01\n2.79400e+02\n▇▃▁▁▁\n\n\nLife expectancy at birth (years)\n1273\n0.90\n6.40400e+01\n1.149000e+01\n18.91\n5.59200e+01\n6.728000e+01\n7.269000e+01\n8.54200e+01\n▁▂▅▇▅\n\n\nPopulation density (people per sq. km of land area)\n604\n0.95\n3.18860e+02\n1.593410e+03\n0.10\n1.97800e+01\n6.401000e+01\n1.448200e+02\n2.13891e+04\n▇▁▁▁▁\n\n\nUnemployment (% of total labor force) (modeled ILO estimate)\n7241\n0.42\n8.30000e+00\n6.290000e+00\n0.14\n3.69000e+00\n6.780000e+00\n1.121000e+01\n3.79400e+01\n▇▅▁▁▁\n\n\nPopulation (M)\n2874\n0.77\n2.99600e+01\n1.158000e+02\n0.01\n1.05000e+00\n5.390000e+00\n1.708000e+01\n1.39190e+03\n▇▁▁▁▁\n\n\n\n\n\n\n# Filter for the year 2014\nworld_bank_2014 = world_bank %&gt;%\n  filter(Year == 2014)\n\nhead(world_bank_2014)\n\n# A tibble: 6 × 16\n  `Country Name` `Country Code` Region  IncomeGroup  Year Birth rate, crude (p…¹\n  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;                  &lt;dbl&gt;\n1 Afghanistan    AFG            South … Low income   2014                   35.7\n2 Albania        ALB            Europe… Upper midd…  2014                   12.3\n3 Algeria        DZA            Middle… Upper midd…  2014                   25.5\n4 American Samoa ASM            East A… Upper midd…  2014                   17.5\n5 Andorra        AND            Europe… High incom…  2014                   NA  \n6 Angola         AGO            Sub-Sa… Upper midd…  2014                   43.2\n# ℹ abbreviated name: ¹​`Birth rate, crude (per 1,000 people)`\n# ℹ 10 more variables: `Death rate, crude (per 1,000 people)` &lt;dbl&gt;,\n#   `Electric power consumption (kWh per capita)` &lt;dbl&gt;, `GDP (USD)` &lt;dbl&gt;,\n#   `GDP per capita (USD)` &lt;dbl&gt;,\n#   `Individuals using the Internet (% of population)` &lt;dbl&gt;,\n#   `Infant mortality rate (per 1,000 live births)` &lt;dbl&gt;,\n#   `Life expectancy at birth (years)` &lt;dbl&gt;, …\n\n# Load HDI table\nhdi = read_csv(\"HDI.csv\")\nhead(hdi)\n\n# A tibble: 6 × 1,008\n  iso3  country hdicode region hdi_rank_2021 hdi_1990 hdi_1991 hdi_1992 hdi_1993\n  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 AFG   Afghan… Low     SA               180    0.273    0.279    0.287    0.297\n2 AGO   Angola  Medium  SSA              148   NA       NA       NA       NA    \n3 ALB   Albania High    ECA               67    0.647    0.629    0.614    0.617\n4 AND   Andorra Very H… &lt;NA&gt;              40   NA       NA       NA       NA    \n5 ARE   United… Very H… AS                26    0.728    0.739    0.742    0.748\n6 ARG   Argent… Very H… LAC               47    0.723    0.73     0.735    0.739\n# ℹ 999 more variables: hdi_1994 &lt;dbl&gt;, hdi_1995 &lt;dbl&gt;, hdi_1996 &lt;dbl&gt;,\n#   hdi_1997 &lt;dbl&gt;, hdi_1998 &lt;dbl&gt;, hdi_1999 &lt;dbl&gt;, hdi_2000 &lt;dbl&gt;,\n#   hdi_2001 &lt;dbl&gt;, hdi_2002 &lt;dbl&gt;, hdi_2003 &lt;dbl&gt;, hdi_2004 &lt;dbl&gt;,\n#   hdi_2005 &lt;dbl&gt;, hdi_2006 &lt;dbl&gt;, hdi_2007 &lt;dbl&gt;, hdi_2008 &lt;dbl&gt;,\n#   hdi_2009 &lt;dbl&gt;, hdi_2010 &lt;dbl&gt;, hdi_2011 &lt;dbl&gt;, hdi_2012 &lt;dbl&gt;,\n#   hdi_2013 &lt;dbl&gt;, hdi_2014 &lt;dbl&gt;, hdi_2015 &lt;dbl&gt;, hdi_2016 &lt;dbl&gt;,\n#   hdi_2017 &lt;dbl&gt;, hdi_2018 &lt;dbl&gt;, hdi_2019 &lt;dbl&gt;, hdi_2020 &lt;dbl&gt;, …\n\n# select only iso3 and hdi_2014 columns\nhdi_2014 = hdi %&gt;% \n  select(iso3, hdi_2014)\n\n# rename iso3 column \nhdi_2014 = hdi_2014 %&gt;%\n  rename(`Country Code` = iso3)\n\n# Join 2014 data with the HDI table\nwb_hdi_2014 = full_join(world_bank_2014, hdi_2014)\nhead(wb_hdi_2014)\n\n# A tibble: 6 × 17\n  `Country Name` `Country Code` Region  IncomeGroup  Year Birth rate, crude (p…¹\n  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;                  &lt;dbl&gt;\n1 Afghanistan    AFG            South … Low income   2014                   35.7\n2 Albania        ALB            Europe… Upper midd…  2014                   12.3\n3 Algeria        DZA            Middle… Upper midd…  2014                   25.5\n4 American Samoa ASM            East A… Upper midd…  2014                   17.5\n5 Andorra        AND            Europe… High incom…  2014                   NA  \n6 Angola         AGO            Sub-Sa… Upper midd…  2014                   43.2\n# ℹ abbreviated name: ¹​`Birth rate, crude (per 1,000 people)`\n# ℹ 11 more variables: `Death rate, crude (per 1,000 people)` &lt;dbl&gt;,\n#   `Electric power consumption (kWh per capita)` &lt;dbl&gt;, `GDP (USD)` &lt;dbl&gt;,\n#   `GDP per capita (USD)` &lt;dbl&gt;,\n#   `Individuals using the Internet (% of population)` &lt;dbl&gt;,\n#   `Infant mortality rate (per 1,000 live births)` &lt;dbl&gt;,\n#   `Life expectancy at birth (years)` &lt;dbl&gt;, …\n\n# Review missing values as % of total DataFrame\ncolSums(is.na(wb_hdi_2014)) / nrow(wb_hdi_2014)*100\n\n                                                Country Name \n                                                    6.222222 \n                                                Country Code \n                                                    0.000000 \n                                                      Region \n                                                    6.222222 \n                                                 IncomeGroup \n                                                    6.222222 \n                                                        Year \n                                                    6.222222 \n                        Birth rate, crude (per 1,000 people) \n                                                    9.333333 \n                        Death rate, crude (per 1,000 people) \n                                                    9.333333 \n                 Electric power consumption (kWh per capita) \n                                                   38.222222 \n                                                   GDP (USD) \n                                                   10.666667 \n                                        GDP per capita (USD) \n                                                   10.666667 \n            Individuals using the Internet (% of population) \n                                                   11.555556 \n               Infant mortality rate (per 1,000 live births) \n                                                   15.555556 \n                            Life expectancy at birth (years) \n                                                   12.444444 \n         Population density (people per sq. km of land area) \n                                                    7.555556 \nUnemployment (% of total labor force) (modeled ILO estimate) \n                                                   17.333333 \n                                              Population (M) \n                                                   10.666667 \n                                                    hdi_2014 \n                                                   10.666667 \n\n\n\n\nPrepare data for visualization\n\n# Summarize GDP by Year and Region\ngdp_pivot = world_bank %&gt;% \n  group_by(Year, Region) %&gt;%\n  summarise(`GDP (Trillions)` = sum(`GDP (USD)`, na.rm = TRUE)/ 1e12)\n\nhead(gdp_pivot)\n\n# A tibble: 6 × 3\n# Groups:   Year [1]\n   Year Region                     `GDP (Trillions)`\n  &lt;dbl&gt; &lt;chr&gt;                                  &lt;dbl&gt;\n1  1960 East Asia & Pacific                   0.146 \n2  1960 Europe & Central Asia                 0.283 \n3  1960 Latin America & Caribbean             0.0574\n4  1960 Middle East & North Africa            0.0141\n5  1960 North America                         0.543 \n6  1960 South Asia                            0.0475\n\n# Summarize Population by Year and Region\npop_pivot = world_bank %&gt;% \n  group_by(Year, Region) %&gt;% \n  summarise(`Population (Billions)` = sum(`Population (M)`, na.rm = TRUE)/1e3)\n                                          \n                                            \nhead(pop_pivot)\n\n# A tibble: 6 × 3\n# Groups:   Year [1]\n   Year Region                     `Population (Billions)`\n  &lt;dbl&gt; &lt;chr&gt;                                        &lt;dbl&gt;\n1  1960 East Asia & Pacific                         0.872 \n2  1960 Europe & Central Asia                       0.281 \n3  1960 Latin America & Caribbean                   0.187 \n4  1960 Middle East & North Africa                  0.0593\n5  1960 North America                               0.181 \n6  1960 South Asia                                  0.573 \n\n# remove missing values from Region and hdi_2014 columns\nwb_hdi_2014 = wb_hdi_2014 %&gt;% \n  filter(!is.na(Region) & !is.na(hdi_2014))\n\n# Summarize HDI by Region\nwb_hdi_by_region &lt;- wb_hdi_2014 %&gt;% \n  group_by(Region) %&gt;% \n  summarise(avg_hdi = mean(hdi_2014)) %&gt;% \n  arrange(desc(avg_hdi))\n\nwb_hdi_by_region\n\n# A tibble: 7 × 2\n  Region                     avg_hdi\n  &lt;chr&gt;                        &lt;dbl&gt;\n1 North America                0.922\n2 Europe & Central Asia        0.845\n3 Latin America & Caribbean    0.740\n4 Middle East & North Africa   0.737\n5 East Asia & Pacific          0.730\n6 South Asia                   0.611\n7 Sub-Saharan Africa           0.528\n\n\n\n\nData Visualization\n\nCreate initial graphs for later integration into a final one-page infographic report\n\n# Plot GDP over time by Region\nggplot(gdp_pivot, aes(x = Year, y = `GDP (Trillions)`, fill = Region)) +\n  geom_area() + \n  labs(x = \"Year\", y = \"GDP (Trillions)\")\n\n\n\n\n\n\n\n# Plot Population over time by Region\npop_pivot %&gt;%\n  ggplot(aes(x = Year, y = `Population (Billions)`, fill = Region)) +\n  geom_area()  +\n  labs(x = \"Year\", y = \"Population (Billions)\")\n\n\n\n\n\n\n\n# Prepare bubble chart data\nbubble_chart_data = wb_hdi_2014 %&gt;% \n  filter(!is.na(`Life expectancy at birth (years)`),\n         !is.na(`GDP per capita (USD)`),\n         !is.na(`Population (M)`))\n\n# Calculate min and max population values\nmin_population = min(bubble_chart_data$`Population (M)`)\nmax_population = max(bubble_chart_data$`Population (M)`)\n\n# Bubble chart: Life expectancy vs GDP per capita\nggplot(bubble_chart_data, \n       aes(x = `Life expectancy at birth (years)`, \n           y = `GDP per capita (USD)`, \n           size = `Population (M)`, \n           color = Region)) +\n  scale_size_continuous(range = c(1, 15), \n                        limits = c(min_population, max_population), \n                        breaks = c(250, 500, 750, 1000, 1250)) +\n  scale_y_log10(labels = scales::comma) +\n  geom_point(alpha = 0.60)\n\n\n\n\n\n\n\nggplot(wb_hdi_by_region, \n       aes(x = reorder(Region, avg_hdi), y = avg_hdi)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue3\", alpha = 0.7) +\n  coord_flip()\n\n\n\n\n\n\n\n# Filter out Iceland\nwb_hdi_2014 &lt;- wb_hdi_2014 %&gt;% filter(`Country Name` != \"Iceland\")\n\n# Electric Power Consumption vs. GDP per Capita\nplot5 = wb_hdi_2014 %&gt;%\n  ggplot(aes(x = `Electric power consumption (kWh per capita)`   , \n             y = `GDP per capita (USD)`, \n             color = hdi_2014)) +\n  geom_point(alpha = 0.6, size = 3) +\n    coord_cartesian(ylim = c(0,125000), xlim = c(0, 20000))\n\n\n\n\nBuild final report\n\nCombine visualizations into a single report style graphic\n\n# Define a custom theme\ncustom_theme &lt;- theme_minimal() +\n  theme( text = element_text(family = \"Times New Roman\"),\n    axis.text = element_text(size = 12, colour = \"#000000\"),\n    axis.title = element_text(size = 13),\n    panel.grid = element_blank(),\n    axis.line = element_line(size = 0.5, color = \"black\"),\n    axis.ticks = element_line(size = 0.5, color = \"black\"))\n\n# Apply the custom theme globally\ntheme_set(custom_theme)\n\n\nplot1 = ggplot(gdp_pivot, aes(x = Year, y = `GDP (Trillions)`,\n                              fill = Region)) + \n  geom_area(alpha = 0.8, colour = \"white\") + \n  scale_fill_brewer(palette = \"Set2\") +\n  scale_y_continuous(expand = c(0, 0)) +\n  labs(x = NULL, y = \"GDP (Trillions)\") +\n  theme(legend.title = element_blank(),\n        legend.position = c(0.02, 1),\n        legend.justification = c(0, 1), # Anchor to the top-right \n        legend.margin = margin(0, 0, 0, 0))\n\nplot1\n\n\n\n\n\n\n\nplot2 = ggplot(pop_pivot, aes(x = Year, y = `Population (Billions)`, fill = Region)) + \n  geom_area(alpha = 0.8, colour = \"white\") + \n  scale_fill_brewer(palette = \"Set2\") +\n  labs(x = NULL, y = \"Population (Billions)\") +\n  scale_y_continuous(breaks = seq(0, 7, by = 1),\n                     expand = c(0, 0)) +\n  theme(legend.position = \"none\",\n        plot.margin = margin(t = 20, r = 80, b = 20, l = 20))\nplot2\n\n\n\n\n\n\n\nplot3 = ggplot(bubble_chart_data, aes(x = `Life expectancy at birth (years)`, y = `GDP per capita (USD)`, \n                                      size = `Population (M)`, color = Region)) +\n  scale_size_continuous(range = c(1, 15),\n                        limits = c(min_population, max_population), breaks = c(250, 500, 750, 1000, 1250)) +\n  scale_color_brewer(palette = \"Set2\") +\n  scale_x_continuous(breaks = seq(50, 85, by = 5)) +\n  scale_y_log10(labels = scales::comma) +\n  geom_point(alpha = 0.8) +\n  theme(plot.margin = margin(t = 20, r = 80, b = 20, l = 10),\n        legend.text = element_text(size = 10),\n        legend.position = c(0, 1), # Position the legend at the top left\n        legend.justification = c(0, 1),\n        legend.direction = \"horizontal\") + # Set legend direction to horizontal\n  guides(colour = \"none\")\n\nplot3\n\n\n\n\n\n\n\nplot4 = ggplot(wb_hdi_by_region, aes(reorder(Region, avg_hdi), avg_hdi, fill = Region)) +\n  geom_col(alpha = 0.8) + \n  scale_fill_brewer(palette = \"Set2\") + \n  labs(x = \"Region\", y = \"Human Development Index (HDI)\") +\n  scale_y_continuous(breaks = seq(0, 0.8, by = 0.2),\n                     expand = c(0, 0)) +\n  theme(axis.text.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        legend.position = \"none\")\n\nplot4\n\n\n\n\n\n\n\nplot5 = ggplot(wb_hdi_2014, aes(x = `Electric power consumption (kWh per capita)`, y = `GDP per capita (USD)`, \n                                color = hdi_2014)) + \n  geom_point(alpha = 0.8, size = 3) + \n  scale_color_viridis(option = \"H\", direction = -1, \n                      breaks = seq(0.4, 0.9, by = 0.1), \n                      guide = guide_legend(override.aes = list(size = 4, shape = 16))) + \n  coord_cartesian(ylim = c(0, 125000), xlim = c(0, 20000)) + \n  scale_y_continuous(labels = scales::comma) + \n  scale_x_continuous(labels = scales::comma) +\n  theme(plot.margin = margin(t = 20, r = 80, b = 80, l = 20))\n\nplot5\n\n\n\n\n\n\n\n\n\n # Combine all plots using patchwork package\ncombined_plot = (plot1 | plot2) / \n                 plot3 /\n                 (plot4 | plot5) +\n  plot_annotation(title = \"World Economic Report (1960-2018)\",\n                  theme = theme(plot.title = element_text(hjust = 0.5, size = 18, face = \"bold\", margin = margin(t = 7, r = 0, b = 20, l = 0))))\n\n# Save the combined plot\nggsave(\"econ_dev_report.png\", combined_plot, width = 10.5, height = 13.5, units = \"in\", bg = \"white\")\n\n# Final edit with Canva"
  }
]